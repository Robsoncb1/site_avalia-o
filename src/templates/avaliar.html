{% extends "base.html" %}
{% block title %}Avaliação do Buffet{% endblock %}
{% block content %}
<section class="section-padding">
    <div class="container">
        <h2 class="section-title">Coco Bambu Alphaville</h2>
        <p class="text-center mb-4">Avalie seu buffet e envie sugestões!</p>

        <form method="POST" action="{{ url_for('avaliacao.submit_avaliacao') }}" class="rating-form" id="avaliacaoForm">
            <div class="form-group"><label for="nome">Nome:</label><input type="text" name="nome" id="nome" class="form-control" required></div>

            {% for campo in ['qualidade', 'variedade', 'apresentacao', 'reposicao', 'atendimento'] %}
            <div class="form-group">
                <label>{{ campo.capitalize() }}:</label>
                <div class="rating">
                    {% for i in range(5, 0, -1) %}
                        <input type="radio" name="{{ campo }}" id="{{ campo }}{{ i }}" value="{{ i }}" required>
                        <label for="{{ campo }}{{ i }}"></label>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}

            <div class="form-group"><label for="comentario">Comentário:</label><textarea name="comentario" rows="4" class="form-control"></textarea></div>
            <div class="form-group"><label for="pratos_favoritos">Pratos favoritos:</label><input type="text" name="pratos_favoritos" class="form-control"></div>
            <div class="form-group"><label for="sugestao_pratos">Sugestão de novos pratos:</label><input type="text" name="sugestao_pratos" class="form-control"></div>

            <div class="form-group">
                <label>Com que frequência você nos visita?</label><br>
                {% for opcao in ['primeira vez', 'raramente', 'as vezes', 'frequentemente'] %}
                    <label><input type="radio" name="frequencia" value="{{ opcao }}" required> {{ opcao.capitalize() }}</label><br>
                {% endfor %}
            </div>

            <div class="form-group">
                <label for="permissao_contato">Permite contato?</label>
                <select name="permissao_contato" id="permissao_contato" class="form-control" onchange="toggleTelefone()">
                    <option value="nao">Não</option>
                    <option value="sim">Sim</option>
                </select>
            </div>

            <div class="form-group" id="telefone-field" style="display: none;">
                <label for="telefone">Telefone:</label>
                <input type="text" name="telefone" class="form-control">
            </div>

            <button type="submit" class="btn">Enviar Avaliação</button>
        </form>
    </div>
</section>

<script>
function toggleTelefone() {
    const select = document.getElementById('permissao_contato');
    const telefoneField = document.getElementById('telefone-field');
    telefoneField.style.display = select.value === 'sim' ? 'block' : 'none';
}
document.addEventListener("DOMContentLoaded", toggleTelefone);
{% if sucesso %}
setTimeout(() => {
  alert("Obrigado por sua avaliação! Ela foi enviada com sucesso.");
  window.location.href = "{{ url_for('avaliacao.avaliar') }}";
}, 300);
{% endif %}
</script>
{% endblock %}
